// ============================================================================
// LoveAlways - Exploit Interface
// ============================================================================

using System.IO.Ports;
using System.Threading;
using System.Threading.Tasks;

namespace LoveAlways.Qualcomm.Exploit
{
    /// <summary>
    /// Exploit Interface
    /// </summary>
    public interface IExploit
    {
        /// <summary>
        /// Exploit Name
        /// </summary>
        string Name { get; }

        /// <summary>
        /// List of supported chips
        /// </summary>
        string[] SupportedChips { get; }

        /// <summary>
        /// Check if the device is exploitable
        /// </summary>
        Task<bool> CanExploitAsync(SerialPort port, PblDeviceInfo deviceInfo, CancellationToken ct);

        /// <summary>
        /// Execute exploit
        /// </summary>
        Task<ExploitResult> ExecuteAsync(SerialPort port, PblDeviceInfo deviceInfo, CancellationToken ct);
    }
}
